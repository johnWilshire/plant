<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>plant: A package for modelling forest trait ecology &amp; evolution: <em>Calculating fitness</em> • plant</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">plant</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/plant.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cohort_spacing.html">plant: A package for modelling forest trait ecology &amp; evolution: _Cohort spacing algorithm_</a>
    </li>
    <li>
      <a href="../articles/developer_notes.html">Developer Notes</a>
    </li>
    <li>
      <a href="../articles/emergent.html">plant: A package for modelling forest trait ecology &amp; evolution: _Patch-level emergent properties_</a>
    </li>
    <li>
      <a href="../articles/equilibrium.html">plant: A package for modelling forest trait ecology &amp; evolution: _Finding demographic equilibrium_</a>
    </li>
    <li>
      <a href="../articles/fitness.html">plant: A package for modelling forest trait ecology &amp; evolution: _Calculating fitness_</a>
    </li>
    <li>
      <a href="../articles/parameters.html">plant: A package for modelling forest trait ecology &amp; evolution: _Modifying parameters_</a>
    </li>
    <li>
      <a href="../articles/patch.html">plant: A package for modelling forest trait ecology &amp; evolution: _Patch-level dynamics_</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>plant: A package for modelling forest trait ecology &amp; evolution: <em>Calculating fitness</em>
</h1>
            
            <h4 class="date">2018-01-04</h4>
          </div>

    
    
<div class="contents">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(plant)</a></code></pre></div>
<p>Start by setting a few parameters; this is the base set of parameters we’ll use.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">p0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/scm_base_parameters.html">scm_base_parameters</a></span>(<span class="st">"FF16"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">p0<span class="op">$</span>control<span class="op">$</span>equilibrium_nsteps &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">p0<span class="op">$</span>control<span class="op">$</span>equilibrium_solver_name &lt;-<span class="st"> "hybrid"</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">p0<span class="op">$</span>disturbance_mean_interval &lt;-<span class="st"> </span><span class="fl">30.0</span></a></code></pre></div>
<p>First, compute the space that any strategy can exist along the “lma” axis:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bounds &lt;-<span class="st"> </span><span class="kw"><a href="../reference/viable_fitness.html">viable_fitness</a></span>(<span class="kw"><a href="../reference/bounds.html">bounds_infinite</a></span>(<span class="st">"lma"</span>), p0)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bounds</a></code></pre></div>
<pre><code>##          lower    upper
## lma 0.02533822 4.989169</code></pre>
<p>Generate a set of trait values across this range and compute the fitness landscape:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">lma &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trait_matrix.html">trait_matrix</a></span>(<span class="kw"><a href="../reference/seq_log.html">seq_log_range</a></span>(bounds, <span class="dv">101</span>), <span class="st">"lma"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">w0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p0)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">plot</span>(lma, w0, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">"Fitness (empty environment)"</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-4-1.png"></p>
<p>Any trait value along this point can persist, so start with random sample (Set seed for random number generator so that get same results when rerun)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">lma1 &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">sample</span>(lma, <span class="dv">4</span>))</a></code></pre></div>
<p>This function takes an lma value, introduces it to the community, runs that out to equilibrium seed rain:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">add_eq &lt;-<span class="st"> </span><span class="cf">function</span>(x, p) {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/expand_parameters.html">expand_parameters</a></span>(<span class="kw"><a href="../reference/trait_matrix.html">trait_matrix</a></span>(x, <span class="st">"lma"</span>), p, <span class="dt">mutant=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="kw"><a href="../reference/equilibrium_seed_rain.html">equilibrium_seed_rain</a></span>(p)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">}</a></code></pre></div>
<p>If run interactively it will produce a lot of output</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(lma1, add_eq, p0)</a></code></pre></div>
<p>Then compute fitness landscapes for each of these:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">w1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(p1, <span class="cf">function</span>(p) <span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">matplot</span>(lma, w1, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="kw">max</span>(w1)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">points</span>(lma1, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-8-1.png"></p>
<p>For this system, there is an evolutionary attractor around lma 0.0825:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">lma_b &lt;-<span class="st"> </span><span class="fl">0.0825</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">p1b &lt;-<span class="st"> </span><span class="kw">add_eq</span>(lma_b, p0)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">w1b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p1b)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-9-1.png"></p>
<p>Zooming in in the vicinity of the result shows that this is disruptive selection: fitness increases to both sides of the resident!</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">lma_detail &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trait_matrix.html">trait_matrix</a></span>(<span class="kw"><a href="../reference/seq_log.html">seq_log</a></span>(lma_b <span class="op">*</span><span class="st"> </span><span class="fl">0.95</span>, lma_b <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>, <span class="dv">51</span>), <span class="st">"lma"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">w1b_detail &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma_detail, p1b)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">plot</span>(lma_detail, w1b_detail, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-10-1.png"></p>
<p>Holding the first species at 0.0825 we can introduce additional species (it’s close enough to the optimum here, though in general this point might move substantially as new species are introduced).</p>
<p>Consider introducing a new species at the point of maximum fitness:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">lma_new &lt;-<span class="st"> </span>lma[<span class="kw">which.max</span>(w1b)]</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">lma_new</a></code></pre></div>
<pre><code>## [1] 0.3748389</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw">abline</span>(<span class="dt">v=</span>lma_new, <span class="dt">col=</span><span class="st">"red"</span>)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-11-1.png"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">p2 &lt;-<span class="st"> </span><span class="kw">add_eq</span>(lma_new, p1b)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">w2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p2)</a></code></pre></div>
<p>After introducing this species, the fitness landscape is <em>drawn down</em> around the second species, with a fitness gradient that points towards increased lma.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">lines</span>(lma, w2)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw">points</span>(lma_new, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">lma_new2 &lt;-<span class="st"> </span>lma[<span class="kw">which.max</span>(w2)]</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="kw">abline</span>(<span class="dt">v=</span>lma_new2)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-12-1.png"></p>
<p>At the cost of extremely tedious copy/paste code, here is the result of repeatedly taking the lma value with highest fitness and moving the second species to this point, running to equilibrium, and plotting. For comparison the previous landscapes are retained as dotted lines.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">p2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">add_eq</span>(lma_new2, p1b)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">w2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p2_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw">lines</span>(lma, w2, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">lines</span>(lma, w2_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw">points</span>(lma_new, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="kw">points</span>(lma_new2, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">lma_new3 &lt;-<span class="st"> </span>lma[<span class="kw">which.max</span>(w2_<span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="kw">abline</span>(<span class="dt">v=</span>lma_new3)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-13-1.png"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">p2_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">add_eq</span>(lma_new3, p1b)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">w2_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p2_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw">lines</span>(lma, w2, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="kw">lines</span>(lma, w2_<span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="kw">lines</span>(lma, w2_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="kw">points</span>(lma_new, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="kw">points</span>(lma_new2, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="kw">points</span>(lma_new3, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">lma_new4 &lt;-<span class="st"> </span>lma[<span class="kw">which.max</span>(w2_<span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">v=</span>lma_new4)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-13-2.png"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">p2_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">add_eq</span>(lma_new4, p1b)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">w2_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span>(lma, p2_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw">plot</span>(lma, w1b, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">     <span class="dt">xlab=</span><span class="st">"Leaf mass per unit leaf area"</span>, <span class="dt">ylab=</span><span class="st">"Fitness"</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">lines</span>(lma, w2, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw">lines</span>(lma, w2_<span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="kw">lines</span>(lma, w2_<span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="kw">lines</span>(lma, w2_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="kw">points</span>(lma_b, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="kw">points</span>(lma_new, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="kw">points</span>(lma_new2, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="kw">points</span>(lma_new3, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="kw">points</span>(lma_new4, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">lma_new5 &lt;-<span class="st"> </span>lma[<span class="kw">which.max</span>(w2_<span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="kw">abline</span>(<span class="dt">v=</span>lma_new5)</a></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-13-3.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Daniel Falster, Richard FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
